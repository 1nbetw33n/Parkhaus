@startuml

title __**stateDiagram booking in CIS**__
state forkBooking <<fork>>
state forkVisaValidity <<fork>>
state forkPaymentOptions <<fork>>
state forkAuthorizationApproval <<fork>>
state forkDecline <<fork>>


[*] --> forkBooking

forkBooking --> bookConference : [book national]
forkBooking --> visaCheck : [book international]

visaCheck --> forkVisaValidity
forkVisaValidity --> bookConference : [is valid]
forkVisaValidity --> visaInvalidError : [is invalid]
bookConference --> PaymentType : redirection to payment

PaymentType --> forkPaymentOptions
forkPaymentOptions --> SEPA : [is SEPA]
forkPaymentOptions --> CreditCard : [is credit card]
SEPA --> Authorization : contacting HypoBank
CreditCard --> Authorization : contacting EasyCredit

Authorization --> forkAuthorizationApproval
forkAuthorizationApproval --> Accept : [issuer approved request]
forkAuthorizationApproval --> Decline : [issuer disapproved request]

Accept --> checkOut : successfully booked
Decline --> forkDecline
forkDecline --> checkOut : [cancel booking]
forkDecline --> PaymentType : return to payment options
visaInvalidError --> checkOut : visa check failed

checkOut --> [*]

@enduml


